# そこの Dockerfile 書いてるあなたちょっと待って、そのコンテナって安全ですか？(DEV-01)

日時：2022/05/12:30 〜 13:15

<br>

## ロールプレイ
初回ヒアリング
- ECS Fargateを使っている
- Java /Spring Bootを利用したWebアプリケーション
- 安全なイメージが作れているか気になる
- Dockerfileの責任の所在があいまい（誰が管理するの？）
- ベースイメージへ何を使うのか深く検討したわけではない

コンテナセキュリティの全体像
- NIST SP800-190「アプリケーションコンテナセキュリティガイド」が全体像の把握の参考になる

コンテナレイヤーの責任が曖昧になりがち
- 開発チームとインフラチームの境界

より安全なコンテナイメージとは
- 必要最小限のコンポーネントを含む
- 必要最小限の権限を持つ
- 脆弱性のあるコンポーネントが含まれていないかをチェックする（脆弱性スキャン）

<br>

## Dockerfileのベストプラクティスを補助するツール

hadolint
- Dockerfileの静的解析ツール
- VS Codeのエクステンション有り
- これいい！

dockle
- コンテナイメージの静的解析ツール
- バイナリ実行可能

<br>

## コンテナイメージの脆弱性スキャンツール

Trivy
- OSパッケージと言語固有の依存関係に対するスキャン
- Dockerfileを含むIaCの静的解析も実施
- バイナリ実行可能

Amazon ECR
- ECRへイメージをpushしたタイミングでスキャンしてくれる
- 手動で対象リポジトリに対してスキャンすることも可能